- name: Move changed files to temporary folder
  if: steps.changed-files-specific.outputs.any_changed == 'true'
  run: |
    TEMP_DIR=$RUNNER_TEMP/changed_files
    mkdir -p $TEMP_DIR
    echo "TEMP_DIR=$TEMP_DIR" >> $GITHUB_ENV
    echo "Temporary directory created at $TEMP_DIR"
    for file in $(echo ${{ steps.changed-files-specific.outputs.all_changed_files }} | jq -r '.[]'); do
      dest_dir="$TEMP_DIR/$(dirname "$file" | sed 's|AutoDuty/Paths/||')"
      mkdir -p "$dest_dir"
      rsync "$file" "$dest_dir/"
    done
    echo "Files moved to $TEMP_DIR"
